Hapag comp:
https://gist.github.com/johnykov/9500eab7ecdb651019da6ed2abd4ea79